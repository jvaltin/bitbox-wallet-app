sudo: required

language: bash

services:
  - docker

addons:
  apt:
    update: true
    packages:
      - docker-ce
      - make

install:
- docker build -t bitbox-wallet-dev .
- docker ps -a
- docker start bitbox-wallet-dev
- docker run --privileged -v "`pwd`":/opt/go/src/github.com/digitalbitbox/bitbox-wallet-app bitbox-wallet-dev


jobs:
  include:
    - stage: docker ci
      script: docker exec -t bitbox-wallet-dev bash -c 'cd /opt/go/src/github.com/digitalbitbox/bitbox-wallet-app && ./scripts/ci.sh'
    - stage: docker ci-fast
      script: docker exec -t bitbox-wallet-dev bash -c 'cd /opt/go/src/github.com/digitalbitbox/bitbox-wallet-app && ./scripts/ci-fast.sh'
    - stage: build linux
      script: docker exec -t bitbox-wallet-dev /bin/bash -c "cd /opt/go/src/github.com/digitalbitbox/bitbox-wallet-app && make clean qt-linux"
